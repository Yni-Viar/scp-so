/*
This is a template of a walking NPC without animations, I've made.
Maybe this code isn't very good, this is an example of making NPCs in Godot.
This code was used from unreleased SCP-131 NPC for this game, which later was used from SCP-939 AI from October 2022...
 - Yni

*/

using Godot;
using System;

public partial class scp131npc_a : CharacterBody3D
{
	Node3D target;

	[Export] float speed = 3.5f;

	public override void _Ready()
	{
	}

	public override void _PhysicsProcess(double delta)
	{
		if (target != null)
		{
			var direction = GlobalPosition.DirectionTo(target.GlobalPosition);
			//var playerDirection = (target.GlobalPosition - this.GlobalPosition).Normalized();
			Velocity += speed * direction;
		}
		MoveAndSlide();
	}

	private void OnFindPlayerAreaBodyEntered(Node3D body)
	{
		if (body.IsInGroup("Players"))
		{
			target = body.GetNode<Node3D>("PlayerFeet");
		}
	}

	private void OnFindPlayerAreaBodyExited(Node3D body)
	{
		if (body.IsInGroup("Players"))
		{
			target = null;
		}
	}
}
